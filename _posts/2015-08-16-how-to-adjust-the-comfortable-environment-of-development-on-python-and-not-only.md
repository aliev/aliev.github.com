---
layout: post
title: How to create comfortable environment for Python development by using vim, fzf, ag
tags: "python, vim, fzf, ag, ctags"
category: en
published: true
---

I have only one text editor and it is Vim. I don't represent as it is possible to work without it. As a terminal multiplexer I use tmux. This tutorial describes how you can install my Vim settings, but you can always make fork and recustomize it under yourself. My main objective was to make as much as possible powerful configuration thus without overloading the editor with a large number of extensions, having left all default Vim keybindings. And so let's start.


# Install all the necessary

First we need to install base vim configuration. Just use the following commands:

{% highlight bash %}
cd ~
git clone https://github.com/aliev/vim.git
mv ~/vim ~/.vim
git clone https://github.com/gmarik/vundle.git ~/.vim/bundle/vundle
echo "source ~/.vim/vimrc" > .vimrc
vim +BundleInstall +qall # Install all plugins
{% endhighlight %}

Do not forget upgrade your vim to 7.4 version

{% hoghlight bash %}

# For mac users
brew install vim
sudo mv /usr/bin/vim /usr/bin/vim73

{% endhighlight %}

This set of commands will install a basic list of extensions and Vundle - simple package manager.

After restarting the editor you'll see something like this:

![Vim without patched fonts](/assets/article_images/2015-08-16-how-to-adjust-the-comfortable-environment-of-development-on-python-and-not-only/vim-without-fonts.png "Vim without patched fonts")

Looks not so nice, isn't it?

To get a more comfortable "Look and Feel" needs to install pached fonts that you can get from the following address: [DroidSansMonoForPowerlinePlusNerdFileTypesPlusPomicons.ttf](https://github.com/aliev/vim/blob/fonts/DroidSansMonoForPowerlinePlusNerdFileTypesPlusPomicons.ttf).

after installing fonts, you should see something like this:

![Vim with patched fonts](/assets/article_images/2015-08-16-how-to-adjust-the-comfortable-environment-of-development-on-python-and-not-only/vim-with-patched-fonts.png "Vim with patched fonts")

# ZSH

For ZSH I use a [ready set of scripts](https://github.com/robbyrussell/oh-my-zsh). ZSH should be used, that's all.

# Auto activate virtual environment for zsh

Automatic activation of the virtual environment greatly accelerates the work. For all my virtual environments, I use the ```.env``` directory of the project root. My record about ```.env``` directory stored in the .gitignore directory, so, this action will not push my ```.env``` in to the repository when I'll do ```git push```


{% highlight bash %}
handle_virtualenv(){
  if [ "$PWD" != "$PREVPWD" ]; then
    PREVPWD="$PWD";
    if [ -n "$PREVENV_PATH" ]; then
      if [ "`echo "$PWD" | grep -c $PREVENV_PATH`" = "0"  ]; then
         deactivate
         echo "> Virtualenv `basename $PWD` deactivated"
         PS1=$PREV_PS1
         PATH=$PREV_PATH
         PREVENV_PATH=
      fi
    fi
    # activate virtualenv dynamically
    if [ -e "$PWD/.env" ] && [ "$PWD" != "$PREVENV_PATH" ]; then
      PREV_PS1="$PS1"
      PREV_PATH="$PATH"
      PREVENV_PATH="$PWD"
      source $PWD/.env/bin/activate
      echo "> Virtualenv `basename $PWD` activated"
    fi
  fi
}

# Change dir hook
function chpwd() {
    # Auto activate virtual environment
    handle_virtualenv
}
{% endhighlight %}

This script automatically activates the virtual environment, when you doing ```cd``` into the project directory with ```.env```

# FZF, Ag, Ctags

This tools list makes easier programmer live. First, let's install them. I'll describe each of them individually.

{% highlight bash %}
# OS X
brew install the_silver_searcher
brew install ctags-exuberant

# Ubuntu
sudo apt-get install exuberant-ctags
sudo apt-get install silversearcher-ag

# Syntastic and Python syntax checker
pip install flake8
{% endhighlight %}

Open your vim and run :FZF command, it will offer to install fzf binary.

That's all!

Our environment is almost completely ready. now time of tmux!

Actually tmux doesn't demand serious settings. You can use my [conf](https://gist.github.com/aliev/6d71f97c85b4a1931b00) generated by [tmuxline](https://github.com/edkolev/tmuxline.vim) plugin (or you can generate your own on the basis of your theme)


{% highlight bash %}
cd ~
mv ~/.tmux.conf ~/.tmux.conf.old
wget https://gist.githubusercontent.com/aliev/6d71f97c85b4a1931b00/raw/946a7f95a2a3365c21c5192301c256bb0874dbe9/.tmux.conf
{% endhighlight %}

I got the following (with tmux)

![Vim and Tmux](/assets/article_images/2015-08-16-how-to-adjust-the-comfortable-environment-of-development-on-python-and-not-only/vim-tmux.png "Vim and Tmux")

The time has come to set up FZF! By default FZF uses the find command to search but this reduces performance. Ag works much more quickly. Add the following line to your ~ / .zshrc

{% highlight bash %}
export FZF_DEFAULT_COMMAND='ag -l -g ""'
{% endhighlight %}

Add the path to the FZF binaries in .zshrc this app will still come in handy:

{% highlight bash %}
export PATH="/.vim/bundle/fzf/bin:$PATH"
{% endhighlight %}

The last setting for ag, you can create ```.agignore``` file in your home directory with a list of files and directories that it should be ignored during the search

My ~/.agignore example:

{% highlight bash %}
*.pdf
*.pyc
*.png
{% endhighlight %}

About all FZF features you can read from [here](https://github.com/junegunn/fzf/wiki)

Now we can see all the possibilities that provides fzf for Vim. I have defined several combinations and commands.

### Key Bindings

| Key Binding         | Action                                  |
| ------------------- | --------------------------------------- |
| ```<leader>f```     | Open files                              |
| ```<leader>s```     | [Jump to tags in the current buffer](http://aliev.me/en/2015/07/23/vim-fzf-and-ctags-quickly-jump-to-declarations.html) (needs exuberant ctags)  |
| ```<leader>v```     | Open files (and split verticaly)        |
| ```<leader>a```     | Search word under cursor by Ag          |


### Command List

| Command             | Action                                            |
| ------------------- | ------------------------------------------------- |
| ```:Ag```           | List all the lines                                |
| ```:Ag <pattern>``` | Narrow ag results within vim                      |
| ```:FZFLines```     | Search lines in all open vim buffers              |
| ```:FZFMru```       | Simple MRU search (list of the last edited files) |


# Jedi-Vim

Best extension, which makes full Python IDE from your Vim! I'll not describe my jedi-vim settings (you can view them in [stuff.vim](https://github.com/aliev/vim/blob/master/stuff.vim#L15) file). I'll describe only jedi key bindings and commands:

| Key Binding or command      | Action                                  |
| --------------------------- | --------------------------------------- |
| ```<leader>d```             | Goto definitions                        |
| ```<leader>g```             | Goto assignments                        |
| ```<leader>r```             | Renaming (refactoring)                  |
| ```<leader>n```             | Shows all the usages of a name          |
| ```K```                     | Show documentation                      |
| ```:Pyimport module.path``` | Open module                             |


# The last words :)

This tutorial will be continuously updated. Stay tuned! Thanks!
